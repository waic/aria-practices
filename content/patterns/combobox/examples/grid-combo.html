<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>グリッドポップアップ付き編集可能コンボボックスの例</title>

    <!-- すべての例で共有されるコア JS および CSS -->
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css">
    <link rel="stylesheet" href="../../../shared/css/core.css">
    <script src="../../../shared/js/examples.js"></script>
    <script src="../../../shared/js/highlight.pack.js"></script>
    <script src="../../../shared/js/app.js"></script>
    <script data-skipto="colorTheme:aria; displayOption:popup; containerElement:div" src="../../../shared/js/skipto.js"></script>

    <!-- この例のための JS および CSS -->
    <link href="css/grid-combo.css" rel="stylesheet">
    <script src="../../../shared/js/utils.js"></script>
    <script src="js/grid-combo.js"></script>
    <script src="js/grid-combo-example.js"></script>
  </head>
  <body>
    <nav aria-label="関連リンク" class="feedback">
      <ul>
        <li><a href="https://github.com/w3c/aria-practices/projects/7">関連する Issues</a></li>
        <li><a href="../combobox-pattern.html">デザインパターン</a></li>
      </ul>
    </nav>
    <main>
      <h1>グリッドポップアップ付き編集可能コンボボックスの例</h1>
      <!-- 翻訳元リビジョン: https://github.com/w3c/aria-practices/tree/2d60c413ec23875a30162364a7e715b26875d9db -->

      <section>
        <h2>この例について</h2>
        <img alt="" class="example-page-example-icon" src="../../../images/pattern-combobox.svg">
        <p>
          以下のコンボボックスの例は、<a href="../combobox-pattern.html">コンボボックスパターン</a>を使用して、提案値のポップアップにグリッドを使用しています。
        </p>
        <p>
          この例では、利用者はボックスに値を入力するか、グリッドポップアップに表示される値のセットから選択することで、果物や野菜の名前を指定することができます。
          テキストボックスにセット内のアイテム名の先頭文字に一致する文字が含まれると、ポップアップが利用可能になります。
          利用者はテキストボックスに任意の値を入力することができます。この実装では、入力を提案値のセット内の値に制限しません。
        </p>
        <p>
          提案値を表示するグリッドには 2 列があります。
          グリッドの各行は 1 つの提案を表し、列 1 には果物や野菜の名前が含まれ、列 2 にはそれが果物か野菜かが記載されています。
        </p>
        <p>類似の例には以下があります:</p>
        <ul>
          <li><a href="combobox-select-only.html">選択のみのコンボボックス</a>: HTML の <code>select</code> 要素に機能的に似た、テキスト入力のない単一選択コンボボックス。</li>
          <li><a href="combobox-autocomplete-both.html">リストおよびインラインオートコンプリート付き編集可能コンボボックス</a>: <q>リストとインラインオートコンプリート</q>として知られるオートコンプリート動作を示す編集可能コンボボックス。</li>
          <li><a href="combobox-autocomplete-list.html">リストオートコンプリート付き編集可能コンボボックス</a>: <q>リストと手動選択</q>として知られるオートコンプリート動作を示す編集可能コンボボックス。</li>
          <li><a href="combobox-autocomplete-none.html">オートコンプリートなしの編集可能コンボボックス</a>: <code>aria-autocomplete=none</code> に関連する動作を示す編集可能コンボボックス。</li>
          <li><a href="combobox-datepicker.html">日付ピッカーコンボボックス</a>: カレンダーグリッドと月および年ごとのナビゲーションボタンを含むダイアログを開く編集可能な日付入力コンボボックス。</li>
        </ul>
      </section>

      <section>
        <div class="example-header">
          <h2 id="ex_label">例</h2>
        </div>
        <div role="separator" id="ex_start_sep" aria-labelledby="ex_label ex_start_sep" aria-label="の開始"></div>
        <div id="ex1">
          <label for="ex1-input" id="ex1-label" class="combobox-label"> 果物と野菜 </label>
          <div class="combobox-wrapper">
            <div id="ex1-combobox">
              <input type="text" role="combobox" aria-haspopup="grid" aria-expanded="false" aria-autocomplete="list" aria-controls="ex1-grid" id="ex1-input">
            </div>
            <div aria-labelledby="ex1-label" role="grid" id="ex1-grid" class="grid hidden"></div>
          </div>
        </div>
        <div role="separator" id="ex_end_sep" aria-labelledby="ex_label ex_end_sep" aria-label="の終了"></div>
      </section>

      <section>
        <h2>アクセシビリティ機能</h2>
        <p>
          ブラウザは、フォーカスのある要素のように <code>aria-activedescendant</code> によって参照される要素の可視性を管理しません。
          キーボードイベントがリストボックス内のアクティブなオプションを変更すると、JavaScript は <code>aria-activedescendant</code> によって参照されるオプションを表示領域にスクロールします。
          <code>aria-activedescendant</code> の可視性を管理することは、コンテンツのサイズを拡大するためにブラウザのズーム機能を使用する人々にとってアクセシビリティのために不可欠です。
        </p>
      </section>

      <section>
        <h2 id="kbd_label">キーボードのサポート</h2>
        <p>
          このページの例のコンボボックスは、以下のキーボードインターフェースを実装しています。
          キーボードインターフェースの他のバリエーションやオプションについては、<a href="../combobox-pattern.html#keyboard_interaction">コンボボックスパターンのキーボードインタラクションセクション</a> に記載されています。
        </p>
        <h3 id="kbd_label_textbox">テキストボックス</h3>
        <table aria-labelledby="kbd_label_textbox kbd_label" class="def">
          <thead>
            <tr>
              <th>キー</th>
              <th>機能</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="textbox-key-down-arrow">
              <th><kbd>下矢印</kbd></th>
              <td>グリッドが表示されている場合、フォーカスを最初の提案値に移動します。</td>
            </tr>
            <tr data-test-id="textbox-key-up-arrow">
              <th><kbd>上矢印</kbd></th>
              <td>グリッドが表示されている場合、フォーカスを最後の提案値に移動します。</td>
            </tr>
            <tr data-test-id="textbox-key-escape">
              <th><kbd>エスケープ</kbd></th>
              <td>
                <ul>
                  <li>グリッドが表示されている場合、それを閉じます。</li>
                  <li>グリッドが表示されていない場合、テキストボックスをクリアします。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="standard-single-line-editing-keys">
              <th>標準の単一行テキスト編集キー</th>
              <td>
                <ul>
                  <li><kbd>Delete</kbd> や <kbd>Shift + 右矢印</kbd> などのカーソル移動およびテキスト操作に使用されるキー。</li>
                  <li>
                    テキストボックスには <code>type=<q>text</q></code> の HTML <code>input</code> が使用されているため、ブラウザはプラットフォーム固有の編集キーを提供します。
                  </li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table> 
      <h3 id="kbd_label_popup">グリッドポップアップ</h3>
        <p>
          <strong>注記:</strong> 視覚的フォーカスがグリッド内にある場合、DOM フォーカスはテキストボックスに残り、テキストボックスの <code>aria-activedescendant</code> の値が視覚的にフォーカスされている要素を参照する値に設定されます。
          以下のキーボードコマンドの説明でフォーカスに言及する場合、それは視覚的フォーカスインジケーターを指します。
          このフォーカスマネジメントテクニックの詳細については、
          <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">aria-activedescendant を使用したコンポジット内のフォーカス管理</a> を参照してください。
        </p>
        <table aria-labelledby="kbd_label_popup kbd_label" class="def">
          <thead>
            <tr>
              <th>キー</th>
              <th>機能</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="popup-key-enter">
              <th><kbd>Enter</kbd></th>
              <td>
                <ul>
                  <li>フォーカスがある行の最初のセルの内容をテキストボックスの値に設定します。</li>
                  <li>グリッドポップアップを閉じます。</li>
                  <li>テキストボックスにフォーカスを設定します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-escape">
              <th><kbd>Escape</kbd></th>
              <td>
                <ul>
                  <li>グリッドを閉じます。</li>
                  <li>テキストボックスに視覚的フォーカスを設定します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-down-arrow">
              <th><kbd>下矢印</kbd></th>
              <td>
                <ul>
                  <li>フォーカスを次の行に移動します。</li>
                  <li>フォーカスが最後の行にある場合、フォーカスを最初の行に移動します。</li>
                  <li>注記: このラッピング動作は、以下に説明するように <kbd>Home</kbd> および <kbd>End</kbd> が編集カーソルを移動する場合に便利です。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-up-arrow">
              <th><kbd>上矢印</kbd></th>
              <td>
                <ul>
                  <li>フォーカスを前の行に移動します。</li>
                  <li>フォーカスが最初の行にある場合、フォーカスを最後の行に移動します。</li>
                  <li>注記: このラッピング動作は、以下に説明するように <kbd>Home</kbd> および <kbd>End</kbd> が編集カーソルを移動する場合に便利です。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-right-arrow">
              <th><kbd>右矢印</kbd></th>
              <td>
                <ul>
                  <li>フォーカスを次のセルに移動します。</li>
                  <li>フォーカスが行の最後のセルにある場合、フォーカスを次の行の最初のセルに移動します。</li>
                  <li>フォーカスが最後の行の最後のセルにある場合、フォーカスを最初の行の最初のセルに移動します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-left-arrow">
              <th><kbd>左矢印</kbd></th>
              <td>
                <ul>
                  <li>フォーカスを前のセルに移動します。</li>
                  <li>フォーカスが行の最初のセルにある場合、フォーカスを前の行の最後のセルに移動します。</li>
                  <li>フォーカスが最初の行の最初のセルにある場合、フォーカスを最後の行の最後のセルに移動します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="popup-key-home">
              <th><kbd>Home</kbd></th>
              <td>フォーカスをテキストボックスに移動し、編集カーソルをフィールドの先頭に置きます。</td>
            </tr>
            <tr data-test-id="popup-key-end">
              <th><kbd>End</kbd></th>
              <td>フォーカスをテキストボックスに移動し、編集カーソルをフィールドの末尾に置きます。</td>
            </tr>
            <tr data-test-id="popup-key-char">
              <th>印刷可能な文字</th>
              <td>
                <ul>
                  <li>フォーカスをテキストボックスに移動します。</li>
                  <li>テキストボックスに文字を入力します。</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2 id="rps_label">ロール、プロパティ、ステート、および tabindex 属性</h2>
        <p>
          このページの例のコンボボックスは、以下の ARIA ロール、ステート、およびプロパティを実装しています。
          他の ARIA ロール、ステート、およびプロパティの適用方法については、<a href="../combobox-pattern.html#roles_states_properties">コンボボックスパターンのロール、ステート、およびプロパティセクション</a>をご覧ください。
        </p>
        <h3 id="rps_label_textbox">テキストボックス</h3>
        <table aria-labelledby="rps_label_textbox rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">ロール</th>
              <th scope="col">属性</th>
              <th scope="col">要素</th>
              <th scope="col">使用法</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="combobox-role">
              <th scope="row">
                <code>combobox</code>
              </th>
              <td></td>
              <td><code>input[type="text"]</code></td>
              <td>要素をコンボボックスとして特定します。</td>
            </tr>
            <tr data-test-id="combobox-aria-haspopup">
              <td></td>
              <th scope="row">
                <code>aria-haspopup="grid"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>コンボボックスが値を提案するために <code>grid</code> をポップアップできることを示します。</td>
            </tr>
            <tr data-test-id="combobox-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="false"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>ポップアップ要素が<strong>表示されていない</strong>ことを示します。</td>
            </tr>
            <tr data-test-id="combobox-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="true"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>ポップアップ要素が<strong>表示されている</strong>ことを示します。</td>
            </tr>
            <tr data-test-id="combobox-id">
              <td></td>
              <th scope="row">
                <code>id="string"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>
                <ul>
                  <li><code>label</code> 要素の <code>for</code> 属性によって参照され、アクセシブルな名前を提供します。</li>
                  <li>HTML 入力要素の推奨される命名方法であり、ラベルをクリックすると入力にフォーカスが移動します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="combobox-aria-autocomplete">
              <td></td>
              <th scope="row">
                <code>aria-autocomplete="list"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>入力のオートコンプリート動作がポップアップで可能な値のリストを提案することを示します。</td>
            </tr>
            <tr data-test-id="combobox-aria-controls">
              <td></td>
              <th scope="row">
                <code>aria-controls="IDREF"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>提案された値をリストするポップアップ要素を特定します。</td>
            </tr>
            <tr data-test-id="combobox-aria-activedescendant">
              <td></td>
              <th scope="row">
                <code>aria-activedescendant="IDREF"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>
                <ul>
                  <li>グリッド内のセルがキーボードフォーカスを持つことを視覚的に示すとき、そのセルを参照します。</li>
                  <li><kbd>Down Arrow</kbd> などのナビゲーションキーが押されたとき、JavaScript が値を変更します。</li>
                  <li>支援技術が、DOM フォーカスが <code>input</code> 要素に残っている間にアプリケーションがフォーカスしている要素を知ることができます。</li>
                  <li>
                    このフォーカスマネジメントテクニックの詳細については、
                    <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">aria-activedescendant を使用したコンポジットのフォーカスマネジメント</a>をご覧ください。
                  </li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="rps_label_popup">グリッドポップアップ</h3>
        <table aria-labelledby="rps_label_popup rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">ロール</th>
              <th scope="col">属性</th>
              <th scope="col">要素</th>
              <th scope="col">使用法</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="grid-role">
              <th scope="row">
                <code>grid</code>
              </th>
              <td></td>
              <td>
                <code>div</code>
              </td>
              <td>要素を <code>grid</code> として特定します。</td>
            </tr>
            <tr data-test-id="grid-aria-labelledby">
              <td></td>
              <th scope="row">
                <code>aria-labelledby="IDREF"</code>
              </th>
              <td><code>div</code></td>
              <td>コンボボックスによって制御される <code>grid</code> 要素のラベルを提供します。</td>
            </tr>
            <tr data-test-id="row-role">
              <th scope="row">
                <code>row</code>
              </th>
              <td></td>
              <td><code>div</code></td>
              <td>行のすべてのセルを含む要素を特定します。</td>
            </tr>
            <tr data-test-id="row-aria-selected">
              <td></td>
              <th scope="row">
                <code>aria-selected="true"</code>
              </th>
              <td><code>div</code></td>
              <td>
                <ul>
                  <li>セルを含む行が選択されていることを視覚的に示すときにセルに指定されます。</li>
                  <li>グリッド内のセルが <code>aria-activedescendant</code> によって参照されているときにのみ発生します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="gridcell-role">
              <th scope="row"><code>gridcell</code></th>
              <td></td>
              <td><code>div</code></td>
              <td>単一のセルの内容を含む要素を特定します。</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2>JavaScript 及び CSS のソースコード</h2>
        <ul id="css_js_files">
          <li>CSS: <a href="css/grid-combo.css" type="tex/css">grid-combo.css</a></li>
          <li>Javascript: <a href="js/grid-combo.js">grid-combo.js</a>, <a href="js/grid-combo-example.js">grid-combo-example.js</a>, <a href="../../../shared/js/utils.js">utils.js</a></li>
        </ul>
      </section>
      
      <section class="example-code">
        <h2 id="sc1_label">HTML のソースコード</h2>
        <p id="sc1_description">以下の HTML コードをコピーするには、CodePen で開いてください。</p>
        <div role="separator" id="sc1_start_sep" aria-labelledby="sc1_start_sep sc1_label" aria-label="の開始"></div>
        <pre><code id="sc1"></code></pre>
        <div role="separator" id="sc1_end_sep" aria-labelledby="sc1_end_sep sc1_label" aria-label="の終了"></div>
        <script>
          sourceCode.add('sc1', 'ex1', 'ex_label', 'css_js_files', 'sc1_description');
          sourceCode.make();
        </script>
      </section>
    </main>
  </body>
</html>
