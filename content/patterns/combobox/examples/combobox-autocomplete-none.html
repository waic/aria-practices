<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>オートコンプリートなし編集可能コンボボックスの例</title>
  
    <!-- Core JS and CSS shared by all examples -->
    <link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/base.css">
    <link rel="stylesheet" href="../../../shared/css/core.css">
    <script src="../../../shared/js/examples.js"></script>
    <script src="../../../shared/js/highlight.pack.js"></script>
    <script src="../../../shared/js/app.js"></script>
    <script data-skipto="colorTheme:aria; displayOption:popup; containerElement:div" src="../../../shared/js/skipto.js"></script>
  
    <!-- JS and CSS for this example -->
    <link href="css/combobox-autocomplete.css" rel="stylesheet">
    <script src="js/combobox-autocomplete.js"></script>
  </head>
  <body>
    <nav aria-label="関連リンク" class="feedback">
      <ul>
        <li><a href="https://github.com/w3c/aria-practices/projects/7">関連するイシュー</a></li>
        <li><a href="../combobox-pattern.html">デザインパターン</a></li>
      </ul>
    </nav>
    <main>
      <h1>オートコンプリートなし編集可能コンボボックスの例</h1>
      <!-- 翻訳元リビジョン: https://github.com/w3c/aria-practices/tree/2d60c413ec23875a30162364a7e715b26875d9db -->

      <section>
        <h2>この例について</h2>
        <img alt="" class="example-page-example-icon" src="../../../images/pattern-combobox.svg">
        <p>
          利用者が以前に検索した用語の仮想リストから用語を選択できるようにする以下のコンボボックスは、<a href="../combobox-pattern.html">コンボボックスパターン</a>をデモンストレーションしています。
          このデザインパターンでは、4 つのオートコンプリートの動作が説明されています。
          この例は、<q>オートコンプリートなし</q>として知られるオートコンプリートの動作を示しています。
          リストボックスのポップアップに表示される用語は、テキストボックスに表示されている文字列とは関係ありません。
          この実装では、テキストボックスがフォーカスを受け取ったときにリストボックスのポップアップが自動的にトリガーされることはありません。利用者がテキストボックスに文字を入力するか、明示的なオープンコマンドを使用したときにリストが開かれます。
        </p>
        <p>類似の例は以下を含みます:</p>
        <ul>
          <li><a href="combobox-select-only.html">選択限定コンボボックス</a>: テキスト入力のない単一選択コンボボックスで、HTML の <code>select</code> 要素と機能的に似ています。</li>
          <li><a href="combobox-autocomplete-both.html">リストとインラインオートコンプリートの両方を備えた編集可能コンボボックス</a>: 「リストとインラインのオートコンプリート」として知られるオートコンプリートの動作を示す編集可能なコンボボックスです。</li>
          <li><a href="combobox-autocomplete-list.html">リストオートコンプリート付き編集可能コンボボックス</a>: オートコンプリートの動作である「リストと手動選択」として知られるオートコンプリートを示す編集可能なコンボボックスです。</li>
          <li><a href="grid-combo.html">グリッドポップアップ付き編集可能コンボボックス</a>: グリッドで提案を表示し、各提案の説明情報をナビゲートできる編集可能なコンボボックスです。</li>
          <li><a href="combobox-datepicker.html">日付選択コンボボックス</a>: カレンダーグリッドと月と年の移動ボタンを含むダイアログが表示される編集可能な日付入力コンボボックスです。</li>
        </ul>
      </section>

      <section>
        <div class="example-header">
          <h2 id="ex_label">例</h2>
        </div>
        <div role="separator" id="ex_start_sep" aria-labelledby="ex_start_sep ex_label" aria-label="の開始"></div>
        <div id="ex1">
          <label for="cb1-input">検索</label>
          <div class="combobox combobox-list">
            <div class="group">
              <input id="cb1-input" class="cb_edit" type="text" role="combobox" aria-autocomplete="none" aria-expanded="false" aria-controls="cb1-listbox">
              <button type="button" id="cb1-button" tabindex="-1" aria-label="前回の検索" aria-expanded="false" aria-controls="cb1-listbox">
                <svg width="18" height="16" aria-hidden="true" focusable="false" style="forced-color-adjust: auto">
                  <polygon class="arrow" stroke-width="0" fill-opacity="0.75" fill="currentcolor" points="3,6 15,6 9,14"></polygon>
                </svg>
              </button>
            </div>
            <ul id="cb1-listbox" role="listbox" aria-label="前回の検索">
              <li id="lb1-01" role="option">天気</li>
              <li id="lb1-02" role="option">サルサレシピ</li>
              <li id="lb1-03" role="option">ニューヨークへの格安航空券</li>
              <li id="lb1-04" role="option">辞書</li>
              <li id="lb1-05" role="option">野球のスコア</li>
              <li id="lb1-06" role="option">ニューヨークのホテル</li>
              <li id="lb1-07" role="option">住宅ローン計算機</li>
              <li id="lb1-08" role="option">近くのレストラン</li>
              <li id="lb1-09" role="option">無料ゲーム</li>
              <li id="lb1-10" role="option">ガソリン価格</li>
              <li id="lb1-11" role="option">クラシック音楽</li>
            </ul>
          </div>
        </div>
        <div role="separator" id="ex_end_sep" aria-labelledby="ex_end_sep ex_label" aria-label="の終了"></div>
      </section>

      <section>
        <h2>アクセシビリティ機能</h2>
        <ul>
          <li>
            ブラウザは、フォーカスを持つ要素と同様に、aria-activedescendant で参照される要素の表示を管理しません。
            キーボードイベントがリストボックスのアクティブな選択肢を変更するとき、JavaScript はaria-activedescendant で参照される選択肢を表示領域にスクロールします。
            aria-activedescendant の表示を管理することは、コンテンツのサイズを拡大するためにブラウザのズーム機能を使用する人々のアクセシビリティにとって重要です。
          </li>
          <li>
            コンボボックスの操作時に知覚性を向上させるために、視覚的なキーボードフォーカスとホバーは CSS の <code>:hover</code> 疑似クラス、<code>focus</code> 及び <code>blur</code> イベントハンドラーを使用してスタイルが適用されます:
            <ul>
              <li>コンボボックスがフォーカスを受け取ったときにそれをわかりやすくするため、フォーカスは 2 ピクセルのフォーカスリングを <code>input</code> 要素と <code>button</code> 要素の両方に作成します。フォーカスリングとコンボボックスの間には 2 ピクセルのスペースがあります。</li>
              <li>リストボックスを開くために入力欄又はボタンをクリックできることをわかりやすくするため、ホバーはフォーカスと同じスタイリングをします。</li>
              <li>視覚障害を持つ人々がコンボボックスを対話型要素として識別できるように、コンボボックス又はリスト上にホバーすると、カーソルがポインターに変わります。</li>
              <li>選択されたリストボックスの選択肢を他の選択肢と区別しやすくするため、選択するとその選択肢の上下に 2 ピクセルのボーダーを作成します。</li>
              <li>
              注記: 透明なボーダーが一部のシステムでオペレーティングシステムの高コントラスト設定が有効になっている場合に表示されるため、透明度は、フォーカスされた要素と他の要素との間に視覚的な違いを作成するために使うことができません。
              透明度の代わりに、フォーカスされた要素はより太いボーダーと少ないパディングを持ちます。
              要素がフォーカスを受け取るとき、ボーダーはゼロから 2 ピクセルに変更され、パディングは 2 ピクセル減少します。
              要素がフォーカスを失うと、ボーダーは 2 ピクセルからゼロに変更され、パディングは 2 ピクセル増加します。
              </li>
            </ul>
          </li>
          <li>
            高コントラスト設定がテキストコンテンツの色を変更する場合、開くボタンの矢印に使用されるインライン SVG グラフィックが背景と十分なコントラストを持つようにするために、<code>svg</code> 要素の CSS の <code>forced-color-adjust</code> を <code>auto</code> に設定し、<code>polygon</code> 要素の <code>fill</code> 属性を <code>currentcolor</code> に設定します。
            これにより、<code>polygon</code> 要素の <code>fill</code> の色は高コントラストカラー設定によって上書きされます。
            <code>forced-color-adjust</code> を使用して <code>fill</code> プロパティの指定された色を上書きしない場合、色は高コントラストモードでも同じままになり、矢印と背景との間の十分なコントラストが得られないか、色が高コントラストモードの背景と一致して見えなくなる可能性があります。<br>
            注記: <code>forced-color-adjust</code> の明示的な設定は、一部のブラウザが SVG グラフィックのデフォルト値として <code>auto</code> を使用しないため必要です。
          </li>
        </ul>
      </section>

      <section>
        <h2 id="kbd_label">キーボードのサポート</h2>
        <p>
          このページのコンボボックスの例では、以下のキーボードインターフェースを実装しています。
          キーボードインターフェースの他のバリエーションやオプションについては、<a href="../combobox-pattern.html#keyboard_interaction">コンボボックスパターンのキーボードインタラクションセクション</a>で説明されています。
        </p>
        <h3 id="kbd_label_textbox">テキストボックス</h3>
        <table aria-labelledby="kbd_label_textbox kbd_label" class="def">
          <thead>
            <tr>
              <th>キー</th>
              <th>機能</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="textbox-key-down-arrow">
              <th><kbd>下矢印</kbd></th>
              <td>
                <ul>
                  <li>リストボックスがまだ表示されていない場合、最初にリストボックスを開き、次に視覚的なフォーカスを最初の選択肢に移動します。</li>
                  <li>DOM のフォーカスはテキストボックスに残ります。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="textbox-key-alt-down-arrow">
              <th><kbd>Alt + 下矢印</kbd></th>
              <td>フォーカスや選択の変更をせずにリストボックスを開きます。</td>
            </tr>
            <tr data-test-id="textbox-key-up-arrow">
              <th><kbd>上矢印</kbd></th>
              <td>
                <ul>
                  <li>リストボックスがまだ表示されていない場合、最初にリストボックスを開き、次に視覚的なフォーカスを最後の選択肢に移動します。</li>
                  <li>DOM のフォーカスはテキストボックスに残ります。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="textbox-key-enter">
              <th><kbd>Enter</kbd></th>
              <td>リストボックスが表示されている場合、リストボックスを閉じます。</td>
            </tr>
            <tr data-test-id="standard-single-line-editing-keys">
              <th>標準の単一行テキスト編集キー</th>
              <td>
                <ul>
                  <li>カーソルの移動やテキストの操作に使用されるキー、例えば <kbd>Delete</kbd> や <kbd>Shift + 右矢印</kbd> など。</li>
                  <li>テキストボックスには <code>type="text"</code> の HTML <code>input</code> が使用されているため、ブラウザがプラットフォーム固有の編集キーを提供します。</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="kbd_label_listbox">リストボックスポップアップ</h3>
        <p>
          <strong>注記:</strong> リストボックスに視覚的なフォーカスがある場合、DOM のフォーカスはテキストボックスに残り、テキストボックスの<code>aria-activedescendant</code> の値は、視覚的にフォーカスされているリストボックスの選択肢を参照する値に設定されます。
          キーボードコマンドの説明で「フォーカス」と言及している場合、視覚的なフォーカスインジケータを指しています。
          このフォーカス管理テクニックの詳細については、
          <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">aria-activedescendant を使用したコンポジット内のフォーカスの管理</a>を参照してください。
  </p>
        <table aria-labelledby="kbd_label_listbox kbd_label" class="def">
          <thead>
            <tr>
              <th>キー</th>
              <th>機能</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="listbox-key-enter">
              <th><kbd>Enter</kbd></th>
              <td>
                <ul>
                  <li>テキストボックスの値をリストボックスのフォーカスされている選択肢の内容に設定します。</li>
                  <li>リストボックスを閉じます。</li>
                  <li>テキストボックスに視覚的なフォーカスを設定します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="listbox-key-escape">
              <th><kbd>Escape</kbd></th>
              <td>
                <ul>
                  <li>リストボックスを閉じます。</li>
                  <li>テキストボックスに視覚的なフォーカスを設定します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="listbox-key-down-arrow">
              <th><kbd>下矢印</kbd></th>
              <td>
                <ul>
                  <li>次の選択肢に視覚的なフォーカスを移動します。</li>
                  <li>視覚的なフォーカスが最後の選択肢にある場合、視覚的なフォーカスを最初の選択肢に移動します。</li>
                  <li>注記: このラッピング動作は、以下で説明するように <kbd> Home</kbd> 及び <kbd>End</kbd> が編集カーソルを移動する場合に便利です。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="listbox-key-up-arrow">
              <th><kbd>上矢印</kbd></th>
              <td>
                <ul>
                  <li>前の選択肢に視覚的なフォーカスを移動します。</li>
                  <li>視覚的なフォーカスが最初の選択肢にある場合、視覚的なフォーカスを最後の選択肢に移動します。</li>
                  <li>注記: このラッピング動作は、以下で説明するように <kbd> Home</kbd> 及び <kbd>End</kbd> が編集カーソルを移動する場合に便利です。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="listbox-key-right-arrow">
              <th><kbd>右矢印</kbd></th>
              <td>テキストボックスに視覚的なフォーカスを移動し、編集カーソルを右に1文字移動します。</td>
            </tr>
            <tr data-test-id="listbox-key-left-arrow">
              <th><kbd>左矢印</kbd></th>
              <td>テキストボックスに視覚的なフォーカスを移動し、編集カーソルを左に1文字移動します。</td>
            </tr>
            <tr data-test-id="listbox-key-home">
              <th><kbd>Home</kbd></th>
              <td>視覚的なフォーカスをテキストボックスに移動し、編集カーソルをフィールドの先頭に移動します。</td>
            </tr>
            <tr data-test-id="listbox-key-end">
              <th><kbd>End</kbd></th>
              <td>視覚的なフォーカスをテキストボックスに移動し、編集カーソルをフィールドの末尾に移動します。</td>
            </tr>
            <tr data-test-id="listbox-key-char">
              <th>印刷可能な文字</th>
              <td>
                <ul>
                  <li>テキストボックスに視覚的なフォーカスを移動します。</li>
                  <li>テキストボックスに文字を入力します。</li>
                  <li>テキストボックス内の文字に基づいてリストボックスの選択肢がフィルタリング<em>されません。</em></li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="kbd_label_button">ボタン</h3>
        <p>ボタンはページのタブシーケンスから削除されていますが、モバイルデバイスでタッチイベントを使用して選択肢のリストを開くために支援技術にとって重要です。</p>
      </section>

      <section>
        <h2 id="rps_label">ロール、プロパティ、状態、及び tabindex 属性</h2>
        <p>
          このページの例のコンボボックスは、以下の ARIA の役割、状態、及びプロパティを実装しています。
          ARIA の役割、状態、及びプロパティの適用方法についての詳細は、<a href="../combobox-pattern.html#roles_states_properties">コンボボックスパターンのロール、状態、及びプロパティのセクション</a>で確認できます。
        </p>
        <h3 id="rps_label_textbox">テキストボックス</h3>
        <table aria-labelledby="rps_label_textbox rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">ロール</th>
              <th scope="col">属性</th>
              <th scope="col">要素</th>
              <th scope="col">使用法</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="combobox-role">
              <th scope="row">
                <code>combobox</code>
              </th>
              <td></td>
              <td><code>input[type="text"]</code></td>
              <td>入力欄をコンボボックスとして識別します。</td>
            </tr>
            <tr data-test-id="combobox-aria-autocomplete">
              <td></td>
              <th scope="row">
                <code>aria-autocomplete="none"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>コンボボックスのポップアップ内の候補が、現在のテキストボックス入力欄を補完する値ではないことを示します。</td>
            </tr>
            <tr data-test-id="combobox-aria-controls">
              <td></td>
              <th scope="row">
                <code>aria-controls="ID_REF"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>ポップアップとして機能する要素を識別します。</td>
            </tr>
            <tr data-test-id="combobox-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="false"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>ポップアップ要素が表示<strong>されていない</strong>ことを示します。</td>
            </tr>
            <tr data-test-id="combobox-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="true"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>ポップアップ要素が表示<strong>されている</strong>ことを示します。</td>
            </tr>
            <tr data-test-id="combobox-id">
              <td></td>
              <th scope="row">
                <code>id="string"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>
                <ul>
                  <li>アクセシブル名を提供するため <code>label</code> 要素の <code>for</code> 属性で参照されます。</li>
                  <li>ラベルをクリックすると入力がフォーカスされるため、HTML の入力要素に対して推奨される命名方法です。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="combobox-aria-activedescendant">
              <td></td>
              <th scope="row">
                <code>aria-activedescendant="ID_REF"</code>
              </th>
              <td><code>input[type="text"]</code></td>
              <td>
                <ul>
                  <li>リストボックス内の選択肢がキーボードフォーカスを持つとして視覚的に示されたとき、その選択肢を参照します。</li>
                  <li>キーボードのナビゲーションキー (例えば <kbd>Down Arrow</kbd>) が押されたときに、JavaScript が値を変更します。</li>
                  <li>DOM のフォーカスが <code>input</code> 要素にある間、アプリケーションがどの要素にフォーカスしているかを支援技術が知れるようにします。</li>
                  <li>
                    このフォーカス管理テクニックの詳細については、
                    <a href="../../../practices/keyboard-interface/keyboard-interface-practice.html#kbd_focus_activedescendant">aria-activedescendant を使用したコンポジットのフォーカス管理</a>を参照してください。
                  </li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="rps_label_listbox">リストボックスポップアップ</h3>
        <table aria-labelledby="rps_label_listbox rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">ロール</th>
              <th scope="col">属性</th>
              <th scope="col">要素</th>
              <th scope="col">使用法</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="listbox-role">
              <th scope="row">
                <code>listbox</code>
              </th>
              <td></td>
              <td>
                <code>ul</code>
              </td>
              <td><code>ul</code> 要素を <code>listbox</code> として識別します。</td>
            </tr>
            <tr data-test-id="listbox-aria-label">
              <td></td>
              <th scope="row">
                <code>aria-label="前回の検索結果"</code>
              </th>
              <td><code>ul</code></td>
              <td><code>listbox</code> のためのラベルを提供します。</td>
            </tr>
            <tr data-test-id="option-role">
              <th scope="row">
                <code>option</code>
              </th>
              <td></td>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li><code>option</code> 要素を <code>listbox</code> の <code>option</code> として識別します。</li>
                  <li>要素のテキストコンテンツは <code>option</code> のアクセシブル名を提供します。</li>
                </ul>
              </td>
            </tr>
            <tr data-test-id="option-aria-selected">
              <td></td>
              <th scope="row">
                <code>aria-selected="true"</code>
              </th>
              <td><code>li</code></td>
              <td>
                <ul>
                  <li>リストボックス内の選択肢が選択されているとして視覚的にハイライトされている場合に指定されます。</li>
                  <li>リスト内の選択肢が <code>aria-activedescendant</code> によって参照される場合にのみ発生します。</li>
                </ul>
              </td>
            </tr>
          </tbody>
        </table>
        <h3 id="rps_label_button">ボタン</h3>
        <table aria-labelledby="rps_label_button rps_label" class="data attributes">
          <thead>
            <tr>
              <th scope="col">ロール</th>
              <th scope="col">属性</th>
              <th scope="col">要素</th>
              <th scope="col">使用法</th>
            </tr>
          </thead>
          <tbody>
            <tr data-test-id="button-tabindex">
              <td></td>
              <th scope="row">
                <code>tabindex="-1"</code>
              </th>
              <td><code>button</code></td>
              <td>このボタンのキーボード機能がリストボックスを開くためのテキストボックスのキーボード操作と重複しているため、このボタンをページのタブシーケンスから削除します。</td>
            </tr>
            <tr data-test-id="button-aria-label">
              <td></td>
              <th scope="row">
                <code>aria-label="前回の検索結果"</code>
              </th>
              <td><code>button</code></td>
              <td><code>button</code> のためのラベルを提供します。</td>
            </tr>
            <tr data-test-id="button-aria-controls">
              <td></td>
              <th scope="row">
                <code>aria-controls="ID_REF"</code>
              </th>
              <td><code>button</code></td>
              <td>ポップアップとして機能する要素を識別します。</td>
            </tr>
            <tr data-test-id="button-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="false"</code>
              </th>
              <td><code>button</code></td>
              <td>ポップアップ要素が表示<strong>されていない</strong>ことを示します。</td>
            </tr>
            <tr data-test-id="button-aria-expanded">
              <td></td>
              <th scope="row">
                <code>aria-expanded="true"</code>
              </th>
              <td><code>button</code></td>
              <td>ポップアップ要素が表示<strong>されている</strong>ことを示します。</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h2>JavaScript と CSS のソースコード</h2>
        <ul id="css_js_files">
          <li>
            CSS:
            <a href="css/combobox-autocomplete.css" type="text/css">combobox-autocomplete.css</a>
          </li>
          <li>
            JavaScript:
            <a href="js/combobox-autocomplete.js" type="text/javascript">combobox-autocomplete.js</a>
          </li>
        </ul>
      </section>
      
      <section class="example-code">
        <h2 id="sc1_label">HTML のソースコード</h2>
        <p id="sc1_description">以下の HTML コードをコピーするには、CodePen で開いてください。</p>
        <div role="separator" id="sc1_start_sep" aria-labelledby="sc1_start_sep sc1_label" aria-label="の開始"></div>
        <pre><code id="sc1"></code></pre>
        <div role="separator" id="sc1_end_sep" aria-labelledby="sc1_end_sep sc1_label" aria-label="の終了"></div>
        <script>
          sourceCode.add('sc1', 'ex1', 'ex_label', 'css_js_files', 'sc1_description');
          sourceCode.make();
        </script>
      </section>
    </main>
  </body>
</html>
